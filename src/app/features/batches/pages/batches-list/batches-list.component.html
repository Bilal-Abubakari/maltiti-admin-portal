<div class="batches-list-container">
  <!-- Page Header -->
  <div class="page-header">
    <div class="page-title">
      <h1>Batches Management</h1>
      <p class="page-description">Track product batches, quality checks, and production dates</p>
    </div>
    <p-button
      icon="pi pi-plus"
      label="Create Batch"
      styleClass="p-button-primary"
      (onClick)="onCreateBatch()"
    />
  </div>

  <!-- Batches Table -->
  <div class="table-card">
    <p-table
      class="p-datatable-sm"
      [loading]="loading()"
      [value]="batches()"
    >
      <ng-template pTemplate="header">
        <tr>
          <th pSortableColumn="batchNumber">
            Batch Number <p-sortIcon field="batchNumber" />
          </th>
          <th pSortableColumn="productionDate">
            Production Date <p-sortIcon field="productionDate" />
          </th>
          <th pSortableColumn="expiryDate">
            Expiry Date <p-sortIcon field="expiryDate" />
          </th>
          <th>Manufacturing Location</th>
          <th>Quality Status</th>
          <th style="width: 120px">Actions</th>
        </tr>
      </ng-template>

      <ng-template let-batch pTemplate="body">
        <tr>
          <!-- Batch Number -->
          <td>
            <span class="batch-number">{{ batch.batchNumber }}</span>
          </td>

          <!-- Production Date -->
          <td>{{ formatDate(batch.productionDate) }}</td>

          <!-- Expiry Date -->
          <td>{{ formatDate(batch.expiryDate) }}</td>

          <!-- Manufacturing Location -->
          <td>{{ batch.manufacturingLocation || 'N/A' }}</td>

          <!-- Quality Status -->
          <td>
            <p-tag
              [severity]="getQualityStatusSeverity(batch.qualityCheckStatus)"
              [value]="batch.qualityCheckStatus || 'Pending'"
            />
          </td>

          <!-- Actions -->
          <td>
            <div class="action-buttons">
              <p-button
                icon="pi pi-eye"
                pTooltip="View Details"
                severity="secondary"
                [rounded]="true"
                [text]="true"
                (onClick)="onViewBatch(batch)"
              />
            </div>
          </td>
        </tr>
      </ng-template>

      <!-- Loading Template -->
      <ng-template pTemplate="loadingbody">
        <tr>
         @for (i of [1, 2, 3, 4, 5, 6]; track i) {
           <td>
             <p-skeleton />
           </td>
         }
        </tr>
      </ng-template>

      <!-- Empty State -->
      <ng-template pTemplate="emptymessage">
        <tr>
          <td class="empty-state" colspan="6">
            <div class="empty-state-content">
              <i class="pi pi-inbox empty-icon"></i>
              <h3>No Batches Found</h3>
              <p>Create your first batch to start tracking production</p>
              <p-button icon="pi pi-plus" label="Create Batch" (onClick)="onCreateBatch()" />
            </div>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</div>
